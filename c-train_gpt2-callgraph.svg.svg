<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="2279pt" height="859pt"
 viewBox="0.00 0.00 2279.10 858.62" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 854.62)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-854.62 2275.1,-854.62 2275.1,4 -4,4"/>
<!-- main -->
<g id="node1" class="node">
<title>main</title>
<ellipse fill="none" stroke="black" cx="156.27" cy="-271" rx="156.04" ry="26.74"/>
<text text-anchor="middle" x="156.27" y="-274.8" font-family="Times,serif" font-size="14.00">int main ()</text>
<text text-anchor="middle" x="156.27" y="-259.8" font-family="Times,serif" font-size="14.00">/root/llm.c/train_gpt2.c:1099</text>
</g>
<!-- gpt2_build_from_checkpoint -->
<g id="node2" class="node">
<title>gpt2_build_from_checkpoint</title>
<ellipse fill="none" stroke="black" cx="752.3" cy="-384" rx="403.52" ry="26.74"/>
<text text-anchor="middle" x="752.3" y="-387.8" font-family="Times,serif" font-size="14.00">void gpt2_build_from_checkpoint (GPT2 *model, const char *checkpoint_path)</text>
<text text-anchor="middle" x="752.3" y="-372.8" font-family="Times,serif" font-size="14.00">/root/llm.c/train_gpt2.c:631</text>
</g>
<!-- main&#45;&gt;gpt2_build_from_checkpoint -->
<g id="edge1" class="edge">
<title>main&#45;&gt;gpt2_build_from_checkpoint</title>
<path fill="none" stroke="black" d="M220.12,-295.6C257,-309.13 304.82,-325.13 348.54,-335 396.69,-345.87 448.66,-354.46 498.75,-361.2"/>
<polygon fill="black" stroke="black" points="498.37,-364.68 508.74,-362.53 499.29,-357.74 498.37,-364.68"/>
</g>
<!-- access -->
<g id="node3" class="node">
<title>access</title>
<ellipse fill="none" stroke="black" cx="752.3" cy="-126" rx="48.19" ry="18"/>
<text text-anchor="middle" x="752.3" y="-122.3" font-family="Times,serif" font-size="14.00">access()</text>
</g>
<!-- main&#45;&gt;access -->
<g id="edge2" class="edge">
<title>main&#45;&gt;access</title>
<path fill="none" stroke="black" d="M189.02,-244.57C225.12,-216.24 287.04,-172.69 348.54,-153 467.35,-114.96 615.67,-116.77 695.01,-121.4"/>
<polygon fill="black" stroke="black" points="695.07,-124.91 705.27,-122.04 695.51,-117.92 695.07,-124.91"/>
</g>
<!-- dataloader_init -->
<g id="node4" class="node">
<title>dataloader_init</title>
<ellipse fill="none" stroke="black" cx="752.3" cy="-636" rx="390.15" ry="26.74"/>
<text text-anchor="middle" x="752.3" y="-639.8" font-family="Times,serif" font-size="14.00">void dataloader_init (DataLoader *loader, const char *filename, int B, int T)</text>
<text text-anchor="middle" x="752.3" y="-624.8" font-family="Times,serif" font-size="14.00">/root/llm.c/train_gpt2.c:1016</text>
</g>
<!-- main&#45;&gt;dataloader_init -->
<g id="edge3" class="edge">
<title>main&#45;&gt;dataloader_init</title>
<path fill="none" stroke="black" d="M170.15,-298.16C196.25,-350.19 260.44,-464.07 348.54,-524 411.66,-566.93 490.9,-593.49 562.35,-609.89"/>
<polygon fill="black" stroke="black" points="561.86,-613.36 572.38,-612.14 563.39,-606.53 561.86,-613.36"/>
</g>
<!-- printf -->
<g id="node5" class="node">
<title>printf</title>
<ellipse fill="none" stroke="black" cx="1637.53" cy="-590" rx="44.39" ry="18"/>
<text text-anchor="middle" x="1637.53" y="-586.3" font-family="Times,serif" font-size="14.00">printf()</text>
</g>
<!-- main&#45;&gt;printf -->
<g id="edge4" class="edge">
<title>main&#45;&gt;printf</title>
<path fill="none" stroke="black" d="M182.65,-297.69C216.87,-331.92 281.32,-390.39 348.54,-420 793.5,-615.97 1402.36,-602.45 1583.59,-593.28"/>
<polygon fill="black" stroke="black" points="1583.85,-596.77 1593.66,-592.76 1583.49,-589.78 1583.85,-596.77"/>
</g>
<!-- tokenizer_init -->
<g id="node6" class="node">
<title>tokenizer_init</title>
<ellipse fill="none" stroke="black" cx="752.3" cy="-72" rx="81.49" ry="18"/>
<text text-anchor="middle" x="752.3" y="-68.3" font-family="Times,serif" font-size="14.00">tokenizer_init()</text>
</g>
<!-- main&#45;&gt;tokenizer_init -->
<g id="edge5" class="edge">
<title>main&#45;&gt;tokenizer_init</title>
<path fill="none" stroke="black" d="M177.21,-244.12C208.58,-204.22 273.67,-130.63 348.54,-99 453.38,-54.72 587.29,-55.75 671.19,-62.43"/>
<polygon fill="black" stroke="black" points="670.91,-65.92 681.17,-63.27 671.5,-58.94 670.91,-65.92"/>
</g>
<!-- mallocCheck -->
<g id="node7" class="node">
<title>mallocCheck</title>
<ellipse fill="none" stroke="black" cx="2195.05" cy="-636" rx="76.09" ry="18"/>
<text text-anchor="middle" x="2195.05" y="-632.3" font-family="Times,serif" font-size="14.00">mallocCheck()</text>
</g>
<!-- main&#45;&gt;mallocCheck -->
<g id="edge6" class="edge">
<title>main&#45;&gt;mallocCheck</title>
<path fill="none" stroke="black" d="M161.48,-298.06C174.42,-371.45 220.78,-575.28 348.54,-672 502.73,-788.73 1914.25,-911.45 2083.01,-817 2141.86,-784.07 2173.3,-705.79 2186.46,-663.78"/>
<polygon fill="black" stroke="black" points="2189.82,-664.76 2189.35,-654.17 2183.12,-662.74 2189.82,-664.76"/>
</g>
<!-- dataloader_free -->
<g id="node8" class="node">
<title>dataloader_free</title>
<ellipse fill="none" stroke="black" cx="752.3" cy="-299" rx="224.31" ry="26.74"/>
<text text-anchor="middle" x="752.3" y="-302.8" font-family="Times,serif" font-size="14.00">void dataloader_free (DataLoader *loader)</text>
<text text-anchor="middle" x="752.3" y="-287.8" font-family="Times,serif" font-size="14.00">/root/llm.c/train_gpt2.c:1062</text>
</g>
<!-- main&#45;&gt;dataloader_free -->
<g id="edge7" class="edge">
<title>main&#45;&gt;dataloader_free</title>
<path fill="none" stroke="black" d="M307.17,-278.07C375.67,-281.29 458.14,-285.18 533.32,-288.73"/>
<polygon fill="black" stroke="black" points="533.25,-292.23 543.4,-289.2 533.58,-285.23 533.25,-292.23"/>
</g>
<!-- tokenizer_free -->
<g id="node9" class="node">
<title>tokenizer_free</title>
<ellipse fill="none" stroke="black" cx="752.3" cy="-18" rx="83.69" ry="18"/>
<text text-anchor="middle" x="752.3" y="-14.3" font-family="Times,serif" font-size="14.00">tokenizer_free()</text>
</g>
<!-- main&#45;&gt;tokenizer_free -->
<g id="edge8" class="edge">
<title>main&#45;&gt;tokenizer_free</title>
<path fill="none" stroke="black" d="M170.64,-244.03C196.9,-194.37 260.45,-89.49 348.54,-45 452.08,7.29 590.1,3.25 674.73,-6.14"/>
<polygon fill="black" stroke="black" points="674.45,-9.63 684.78,-7.31 675.25,-2.67 674.45,-9.63"/>
</g>
<!-- gpt2_free -->
<g id="node10" class="node">
<title>gpt2_free</title>
<ellipse fill="none" stroke="black" cx="752.3" cy="-189" rx="161.44" ry="26.74"/>
<text text-anchor="middle" x="752.3" y="-192.8" font-family="Times,serif" font-size="14.00">void gpt2_free (GPT2 *model)</text>
<text text-anchor="middle" x="752.3" y="-177.8" font-family="Times,serif" font-size="14.00">/root/llm.c/train_gpt2.c:982</text>
</g>
<!-- main&#45;&gt;gpt2_free -->
<g id="edge9" class="edge">
<title>main&#45;&gt;gpt2_free</title>
<path fill="none" stroke="black" d="M248.83,-249.24C280.29,-242.33 315.83,-235.15 348.54,-230 429.44,-217.25 520.13,-207.61 594.94,-200.9"/>
<polygon fill="black" stroke="black" points="595.27,-204.38 604.92,-200.01 594.65,-197.41 595.27,-204.38"/>
</g>
<!-- free -->
<g id="node11" class="node">
<title>free</title>
<ellipse fill="none" stroke="black" cx="1637.53" cy="-176" rx="36.29" ry="18"/>
<text text-anchor="middle" x="1637.53" y="-172.3" font-family="Times,serif" font-size="14.00">free()</text>
</g>
<!-- main&#45;&gt;free -->
<g id="edge10" class="edge">
<title>main&#45;&gt;free</title>
<path fill="none" stroke="black" d="M307.95,-264.54C584.54,-252.61 1146.06,-228.06 1156.06,-225 1173.99,-219.51 1174.17,-208.62 1192.06,-203 1332.34,-158.9 1509.54,-165.43 1591.35,-171.69"/>
<polygon fill="black" stroke="black" points="1591.53,-175.22 1601.78,-172.53 1592.09,-168.24 1591.53,-175.22"/>
</g>
<!-- gpt2_build_from_checkpoint&#45;&gt;printf -->
<g id="edge12" class="edge">
<title>gpt2_build_from_checkpoint&#45;&gt;printf</title>
<path fill="none" stroke="black" d="M955.26,-407.29C1024.59,-423.33 1099.02,-450.39 1156.06,-496 1182.46,-517.11 1163.58,-544.78 1192.06,-563 1316.43,-642.58 1502.61,-618.45 1589.16,-601.06"/>
<polygon fill="black" stroke="black" points="1590.12,-604.43 1599.21,-598.98 1588.71,-597.58 1590.12,-604.43"/>
</g>
<!-- fopenCheck -->
<g id="node12" class="node">
<title>fopenCheck</title>
<ellipse fill="none" stroke="black" cx="1637.53" cy="-410" rx="71.49" ry="18"/>
<text text-anchor="middle" x="1637.53" y="-406.3" font-family="Times,serif" font-size="14.00">fopenCheck()</text>
</g>
<!-- gpt2_build_from_checkpoint&#45;&gt;fopenCheck -->
<g id="edge11" class="edge">
<title>gpt2_build_from_checkpoint&#45;&gt;fopenCheck</title>
<path fill="none" stroke="black" d="M1121.79,-394.85C1282.89,-399.59 1457.34,-404.72 1556.15,-407.63"/>
<polygon fill="black" stroke="black" points="1556.26,-411.14 1566.36,-407.93 1556.47,-404.14 1556.26,-411.14"/>
</g>
<!-- exit -->
<g id="node13" class="node">
<title>exit</title>
<ellipse fill="none" stroke="black" cx="1637.53" cy="-536" rx="35.19" ry="18"/>
<text text-anchor="middle" x="1637.53" y="-532.3" font-family="Times,serif" font-size="14.00">exit()</text>
</g>
<!-- gpt2_build_from_checkpoint&#45;&gt;exit -->
<g id="edge13" class="edge">
<title>gpt2_build_from_checkpoint&#45;&gt;exit</title>
<path fill="none" stroke="black" d="M855.31,-410.09C937.11,-431.56 1054.59,-463.62 1156.06,-496 1172.26,-501.17 1175.4,-505.56 1192.06,-509 1336.07,-538.73 1511.45,-539.19 1592.09,-537.46"/>
<polygon fill="black" stroke="black" points="1592.45,-540.95 1602.37,-537.21 1592.29,-533.95 1592.45,-540.95"/>
</g>
<!-- freadCheck -->
<g id="node14" class="node">
<title>freadCheck</title>
<ellipse fill="none" stroke="black" cx="1637.53" cy="-356" rx="70.39" ry="18"/>
<text text-anchor="middle" x="1637.53" y="-352.3" font-family="Times,serif" font-size="14.00">freadCheck()</text>
</g>
<!-- gpt2_build_from_checkpoint&#45;&gt;freadCheck -->
<g id="edge14" class="edge">
<title>gpt2_build_from_checkpoint&#45;&gt;freadCheck</title>
<path fill="none" stroke="black" d="M1117.01,-372.47C1280.04,-367.3 1457.7,-361.67 1557.28,-358.51"/>
<polygon fill="black" stroke="black" points="1557.67,-362 1567.56,-358.19 1557.45,-355.01 1557.67,-362"/>
</g>
<!-- fill_in_parameter_sizes -->
<g id="node15" class="node">
<title>fill_in_parameter_sizes</title>
<ellipse fill="none" stroke="black" cx="1637.53" cy="-293" rx="359.83" ry="26.74"/>
<text text-anchor="middle" x="1637.53" y="-296.8" font-family="Times,serif" font-size="14.00">void fill_in_parameter_sizes (size_t *param_sizes, GPT2Config config)</text>
<text text-anchor="middle" x="1637.53" y="-281.8" font-family="Times,serif" font-size="14.00">/root/llm.c/train_gpt2.c:510</text>
</g>
<!-- gpt2_build_from_checkpoint&#45;&gt;fill_in_parameter_sizes -->
<g id="edge15" class="edge">
<title>gpt2_build_from_checkpoint&#45;&gt;fill_in_parameter_sizes</title>
<path fill="none" stroke="black" d="M958.17,-360.85C1021.67,-353.19 1091.83,-344.25 1156.06,-335 1172.11,-332.69 1175.96,-330.99 1192.06,-329 1246.06,-322.33 1303.91,-316.6 1359.42,-311.81"/>
<polygon fill="black" stroke="black" points="1359.73,-315.3 1369.4,-310.96 1359.13,-308.32 1359.73,-315.3"/>
</g>
<!-- malloc_and_point_parameters -->
<g id="node16" class="node">
<title>malloc_and_point_parameters</title>
<ellipse fill="none" stroke="black" cx="1637.53" cy="-473" rx="445.45" ry="26.74"/>
<text text-anchor="middle" x="1637.53" y="-476.8" font-family="Times,serif" font-size="14.00">float *malloc_and_point_parameters (ParameterTensors *params, size_t *param_sizes)</text>
<text text-anchor="middle" x="1637.53" y="-461.8" font-family="Times,serif" font-size="14.00">/root/llm.c/train_gpt2.c:534</text>
</g>
<!-- gpt2_build_from_checkpoint&#45;&gt;malloc_and_point_parameters -->
<g id="edge16" class="edge">
<title>gpt2_build_from_checkpoint&#45;&gt;malloc_and_point_parameters</title>
<path fill="none" stroke="black" d="M937.51,-407.89C1015.9,-417.63 1108.37,-428.56 1192.06,-437 1242.26,-442.06 1295.71,-446.88 1347.5,-451.25"/>
<polygon fill="black" stroke="black" points="1347.23,-454.74 1357.49,-452.09 1347.82,-447.77 1347.23,-454.74"/>
</g>
<!-- fcloseCheck -->
<g id="node17" class="node">
<title>fcloseCheck</title>
<ellipse fill="none" stroke="black" cx="1637.53" cy="-230" rx="72.59" ry="18"/>
<text text-anchor="middle" x="1637.53" y="-226.3" font-family="Times,serif" font-size="14.00">fcloseCheck()</text>
</g>
<!-- gpt2_build_from_checkpoint&#45;&gt;fcloseCheck -->
<g id="edge17" class="edge">
<title>gpt2_build_from_checkpoint&#45;&gt;fcloseCheck</title>
<path fill="none" stroke="black" d="M1092.47,-369.38C1115.07,-360.49 1136.56,-349.21 1156.06,-335 1186.91,-312.51 1160.53,-278.54 1192.06,-257 1249.31,-217.87 1444.6,-220.32 1556.34,-225.3"/>
<polygon fill="black" stroke="black" points="1556.4,-228.8 1566.56,-225.77 1556.73,-221.81 1556.4,-228.8"/>
</g>
<!-- dataloader_init&#45;&gt;printf -->
<g id="edge20" class="edge">
<title>dataloader_init&#45;&gt;printf</title>
<path fill="none" stroke="black" d="M1064.07,-619.81C1255.07,-609.87 1481.95,-598.05 1583.18,-592.78"/>
<polygon fill="black" stroke="black" points="1583.64,-596.26 1593.44,-592.24 1583.27,-589.27 1583.64,-596.26"/>
</g>
<!-- dataloader_init&#45;&gt;mallocCheck -->
<g id="edge24" class="edge">
<title>dataloader_init&#45;&gt;mallocCheck</title>
<path fill="none" stroke="black" d="M1142.71,-636C1473.36,-636 1922.87,-636 2108.49,-636"/>
<polygon fill="black" stroke="black" points="2108.73,-639.5 2118.73,-636 2108.73,-632.5 2108.73,-639.5"/>
</g>
<!-- dataloader_init&#45;&gt;exit -->
<g id="edge21" class="edge">
<title>dataloader_init&#45;&gt;exit</title>
<path fill="none" stroke="black" d="M883.83,-610.62C970.83,-594.61 1087.9,-574.8 1192.06,-563 1337.99,-546.47 1512.1,-539.61 1592.2,-537.16"/>
<polygon fill="black" stroke="black" points="1592.52,-540.66 1602.41,-536.86 1592.32,-533.66 1592.52,-540.66"/>
</g>
<!-- fopen -->
<g id="node18" class="node">
<title>fopen</title>
<ellipse fill="none" stroke="black" cx="1637.53" cy="-790" rx="43.59" ry="18"/>
<text text-anchor="middle" x="1637.53" y="-786.3" font-family="Times,serif" font-size="14.00">fopen()</text>
</g>
<!-- dataloader_init&#45;&gt;fopen -->
<g id="edge19" class="edge">
<title>dataloader_init&#45;&gt;fopen</title>
<path fill="none" stroke="black" d="M825.89,-662.39C911.97,-692.42 1060.39,-740.23 1192.06,-763 1332.1,-787.21 1500.21,-790.57 1583.87,-790.55"/>
<polygon fill="black" stroke="black" points="1583.89,-794.05 1593.89,-790.53 1583.88,-787.05 1583.89,-794.05"/>
</g>
<!-- fseekCheck -->
<g id="node19" class="node">
<title>fseekCheck</title>
<ellipse fill="none" stroke="black" cx="1637.53" cy="-736" rx="70.39" ry="18"/>
<text text-anchor="middle" x="1637.53" y="-732.3" font-family="Times,serif" font-size="14.00">fseekCheck()</text>
</g>
<!-- dataloader_init&#45;&gt;fseekCheck -->
<g id="edge22" class="edge">
<title>dataloader_init&#45;&gt;fseekCheck</title>
<path fill="none" stroke="black" d="M883.83,-661.38C970.83,-677.39 1087.9,-697.2 1192.06,-709 1319.46,-723.43 1468.35,-730.49 1557.41,-733.68"/>
<polygon fill="black" stroke="black" points="1557.32,-737.18 1567.43,-734.03 1557.56,-730.18 1557.32,-737.18"/>
</g>
<!-- ftell -->
<g id="node20" class="node">
<title>ftell</title>
<ellipse fill="none" stroke="black" cx="1637.53" cy="-682" rx="36.29" ry="18"/>
<text text-anchor="middle" x="1637.53" y="-678.3" font-family="Times,serif" font-size="14.00">ftell()</text>
</g>
<!-- dataloader_init&#45;&gt;ftell -->
<g id="edge23" class="edge">
<title>dataloader_init&#45;&gt;ftell</title>
<path fill="none" stroke="black" d="M1064.07,-652.19C1260.15,-662.4 1494.04,-674.58 1590.98,-679.63"/>
<polygon fill="black" stroke="black" points="1590.86,-683.13 1601.03,-680.15 1591.22,-676.14 1590.86,-683.13"/>
</g>
<!-- dataloader_free&#45;&gt;free -->
<g id="edge26" class="edge">
<title>dataloader_free&#45;&gt;free</title>
<path fill="none" stroke="black" d="M943.58,-313.01C1014.67,-310 1093.3,-296.16 1156.06,-258 1181.02,-242.82 1166.79,-217.67 1192.06,-203 1322.03,-127.55 1510.9,-151.12 1594.28,-166.83"/>
<polygon fill="black" stroke="black" points="1593.67,-170.28 1604.15,-168.75 1595,-163.4 1593.67,-170.28"/>
</g>
<!-- dataloader_free&#45;&gt;fcloseCheck -->
<g id="edge25" class="edge">
<title>dataloader_free&#45;&gt;fcloseCheck</title>
<path fill="none" stroke="black" d="M922.21,-281.45C1003.69,-273.33 1102.89,-263.97 1192.06,-257 1319.15,-247.06 1466.92,-238.72 1556.01,-234.05"/>
<polygon fill="black" stroke="black" points="1556.24,-237.54 1566.04,-233.52 1555.88,-230.55 1556.24,-237.54"/>
</g>
<!-- gpt2_free&#45;&gt;free -->
<g id="edge27" class="edge">
<title>gpt2_free&#45;&gt;free</title>
<path fill="none" stroke="black" d="M912.99,-186.65C1119.2,-183.61 1466.35,-178.5 1590.59,-176.68"/>
<polygon fill="black" stroke="black" points="1590.93,-180.17 1600.88,-176.52 1590.83,-173.17 1590.93,-180.17"/>
</g>
<!-- malloc_and_point_parameters&#45;&gt;mallocCheck -->
<g id="edge18" class="edge">
<title>malloc_and_point_parameters&#45;&gt;mallocCheck</title>
<path fill="none" stroke="black" d="M2026.94,-486.13C2046.31,-492.43 2065.12,-499.99 2083.01,-509 2126.87,-531.09 2160.91,-578.72 2179.18,-608.96"/>
<polygon fill="black" stroke="black" points="2176.25,-610.89 2184.34,-617.74 2182.29,-607.34 2176.25,-610.89"/>
</g>
</g>
</svg>
